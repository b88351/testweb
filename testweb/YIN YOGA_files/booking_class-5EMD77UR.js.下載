var Le=Object.defineProperty;var Fe=(t,e,n)=>e in t?Le(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var m=(t,e)=>()=>(t&&(e=t(t=0)),e);var Ie=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var f=(t,e,n)=>(Fe(t,typeof e!="symbol"?e+"":e,n),n);var T,W=m(()=>{"use strict";T=gm.l10n});function De(t){let e="";return typeof t=="function"?e=t.toString():t===void 0?e="undefined":e=JSON.stringify(t),e}var _,R,F=m(()=>{"use strict";_=class extends Error{};R=class extends _{constructor(e,n){super(`Invalid value for \`${e}\`: ${De(n)}`)}}});function v(t){let e={};return t?Object.keys(t).filter(n=>t[n]!==void 0).reduce((n,r)=>(n[r]=t[r],n),e):void 0}var I=m(()=>{"use strict"});var E,w,Z=m(()=>{"use strict";E=class{constructor(e){f(this,"_element");this._element=typeof e=="string"?$(e):e}get element(){return this.element}fadeIn(){return this._element.removeClass("out").addClass("in")}fadeOut(){return this._element.removeClass("in").addClass("out")}show(){return this.fadeIn(),this._element.addClass(E.className).html(`
				<div class="small1">
					<div class="small ball smallball1"></div>
					<div class="small ball smallball2"></div>
					<div class="small ball smallball3"></div>
					<div class="small ball smallball4"></div>
				</div>
				<div class="small2">
					<div class="small ball smallball5"></div>
					<div class="small ball smallball6"></div>
					<div class="small ball smallball7"></div>
					<div class="small ball smallball8"></div>
				</div>
				<div class="bigcon">
					<div class="big ball"></div>
				</div>
		`)}hide(){return this.fadeOut(),this._element.empty().removeClass(E.className)}async wrapAsync(e){this.show();let n=await e();return this.hide(),n}},w=E;f(w,"className","loadingAnimation2 miniLoadingAnimation")});function ie(t){var d,i;t.close_button&&!t.close_button.title&&(t.close_button.title=t.close_button.label),t.primary_button&&!t.primary_button.title&&(t.primary_button.title=t.primary_button.label);let e={...te,...v((d=t.close_button)!=null?d:{})},n={...ee,...v((i=t.primary_button)!=null?i:{})};if(t.close_button=e,t.primary_button=n,o.modalOptions={...Qe,...v(t)},V(),He(),o.alive=!0,o.modalOptions.show_loader){let l=gm.E("div",{class:"loader-animation"});o.$body.append(l),o.$loader=new w($(l)),o.$loader.show()}if(o.modalOptions.show_header_close_button?(o.$header_close_button.removeClass("none"),o.$header_close_button.on("click",Q)):(o.$header_close_button.addClass("none"),o.$header_close_button.off("click",Q)),(o.modalOptions.actionbutton_list||[o.modalOptions.close_button,o.modalOptions.primary_button]).forEach(l=>{let c;l.is_primary?(c=D({...ee,...l}),o.$primary_button=c):l.is_close?(c=D({...te,...l}),o.$close_button=c):c=D(l),o.actionbutton_list.push(c),o.$actionsContainer.append(c)}),o.modalOptions.settings_link&&gm.config.hasRole("setting_admin")){let l=o.modalOptions.settings_link.classes||"btn-default justify-left settings-link";o.$settings_link.removeClass().addClass(l).find(".link-text").text(o.modalOptions.settings_link.label).on("click",o.modalOptions.on_settings_click)}o.$title.append(o.modalOptions.title),o.$contentOriginalParent=$(o.modalOptions.body).parent(),o.$body.append($(o.modalOptions.body).removeClass("none")),O().scrollTop(0);let s=O().find("div.modal-dialog");return t.modal_classes?s.removeClass().addClass(`modal-dialog ${t.modal_classes}`):s.removeClass().addClass("modal-dialog"),O().modal("show"),$("body").addClass("modal-open"),t.runInModal&&typeof t.runInModal=="function"&&t.runInModal.call({}),t.runCloseOnComplete&&t.runCloseOnComplete().then(()=>V()),new Promise((l,c)=>{o.onDone=l,o.onError=c})}function O(){if(!o.$elem||!o.alive)throw new _("Modal is not ready yet or was destroyed");return o.$elem}async function le(t,e,n){(t==="closed"||e)&&ne(),n&&typeof n=="function"&&await n(),o.onDone({[t]:!0,modal:{hide:ne,clearLoader:Ve,getElem:O}})}function D({classes:t,label:e,result_name:n,eventName:r,autoClose:s,title:d}){return $(gm.E("button",{class:t,title:d,onClick:()=>le(n,s,r)},e))}function He(){let t=gm.config.hasRole("setting_admin")&&o.modalOptions.settings_link?gm.E("a",{class:"btn-default justify-left settings-link"},gm.E("span",{class:"glyphicon glyphicon-cog"}),gm.E("span",{class:"link-text","data-l10n-id":"default-settings-btn-label"})):gm.E(gm.F,null),e=gm.config.BOOTSTRAP_VERSION==5?gm.E("button",{type:"button",class:"btn-close","data-dismiss":"modal","data-bs-dismiss":"modal"},gm.E("span",{class:"sr-only","data-l10n-id":"default-modal-close-button-label"})):gm.E("button",{type:"button",class:"close","data-dismiss":"modal"},gm.E("span",{"aria-hidden":"true"},"\xD7"),gm.E("span",{class:"sr-only","data-l10n-id":"default-modal-close-button-label"}));o.$elem=$(gm.E("div",{class:"modal",id:"gm-modal",tabIndex:-1,role:"dialog","aria-labelledby":"gm-modal-title","aria-hidden":"true","data-backdrop":"static","data-keyboard":"false"},gm.E("div",{class:"modal-dialog"},gm.E("div",{class:"modal-content col-xs-12 col-sm-12"},gm.E("div",{class:"modal-header col-xs-12 col-sm-12"},gm.E("h4",{class:"modal-title",id:"gm-modal-title"}),e),gm.E("div",{class:"modal-body col-xs-12 col-sm-12"}),gm.E("div",{class:"modal-footer col-xs-12 col-sm-12"},gm.E("div",{class:"edit-mode add-mode modal-actions flex flex-wrap align-center justify-right"},t)))))).appendTo("body"),o.$elem.on("hidden.bs.modal",()=>{setTimeout(Q,100)}),o.$body=o.$elem.find(".modal-body"),o.$title=o.$elem.find(".modal-title"),o.$settings_link=o.$elem.find(".modal-footer .modal-actions .settings-link"),o.$actionsContainer=o.$elem.find(".modal-footer .modal-actions"),o.$header_close_button=o.$elem.find(".modal-header .close")}function V(){var t;!o.alive||(o.$loader&&(o.$loader.hide().remove(),o.$loader=void 0),(t=o.$contentOriginalParent)!=null&&t.length&&$(o.modalOptions.body).appendTo(o.$contentOriginalParent).addClass("none"),o.$body.empty(),o.$title.empty(),o.actionbutton_list.forEach(e=>{e.remove()}),o.actionbutton_list=[],o.$settings_link.length>0&&(o.$settings_link.off(),o.$settings_link.remove()),o.$elem.on("hide.bs.modal",Je),o.alive=!1,o.$elem.modal("hide"))}function Je(){o.$elem&&($("body").removeClass("modal-open"),o.$elem.remove(),o.$elem=null)}var o,Qe,oe,re,ee,se,ae,te,Ve,ne,Q,de=m(()=>{"use strict";W();F();I();Z();o={alive:!1,actionbutton_list:[]},Qe={title:"",body:"",settings_link:null,actionbutton_list:null,show_loader:!1,show_header_close_button:!0},ee={label:(oe=T.formatValue("default-modal-ok-button-label"))!=null?oe:"Ok",title:(re=T.formatValue("default-modal-ok-save-changes"))!=null?re:"Save changes",classes:"btn btn-success",result_name:"confirmed",is_primary:!0,is_close:!1},te={label:(se=T.formatValue("default-modal-close-button-label"))!=null?se:"Close",title:(ae=T.formatValue("default-modal-close-button-title"))!=null?ae:"Close without saving",classes:"btn btn-danger me-1",result_name:"closed",is_close:!0,is_primary:!1};Ve=()=>{var t;(t=o.$loader)==null||t.hide()},ne=()=>{o.$elem&&o.$elem.modal("hide"),V()};Q=()=>le("closed")});function ce(t,e,n){if(!n)throw new R(t,e[t])}var ue=m(()=>{"use strict";F()});function me(t,e=Ue){var i,l,c;let r=$(".modal.in").length?$(".modal.in .modal-body"):$("html, body, .affix-row, #page-wrapper, main"),s=(i=(t!=null?t:r).offset())==null?void 0:i.top,d=(c=(l=$("main").children().offset())==null?void 0:l.top)!=null?c:0;s!==void 0&&r.animate({scrollTop:s-(d+e)},500)}var Ue,pe=m(()=>{"use strict";Ue=100});function Ke(t=$(".modal.in").length?$(".modal.in .modal-body"):$("#flash_div")){t.length&&t.find(".alert").addClass("none")}function C(t){var d,i;let e,n,r;return typeof t=="object"&&t.code?(e=t.code,n=(d=t.args)!=null?d:void 0,r=(i=t.message)!=null?i:`Translation Error occurred while rendering another message: ${e}, ${JSON.stringify(n)}`):r=$(`<span>${t.toString()}</span>`)[0],gm.E("span",{"data-l10n-id":e,"data-l10n-args":n,style:{whiteSpace:"pre-wrap"}},r)}function fe(t,e,n={}){var l,c;let r=gm.config.BOOTSTRAP_VERSION,s=(l=n.prependTo)!=null?l:$(".modal.in:not(.no-flash)").length?$(".modal.in .modal-body"):$(".modal.show:not(.no-flash)").length?$(".modal.show .modal-body"):$("#flash_div"),d=(c=n.clear)!=null?c:!0,i;e instanceof HTMLElement||e instanceof DocumentFragment?i=e:i=C(e),s.length?(d&&Ke(s),r==3?s.prepend(gm.E("div",{class:`alert alert-${t} alert-dismissible col-xs-12`},gm.E("button",{"aria-hidden":"true","data-dismiss":"alert",class:"close",type:"button"},"\xD7"),i)):s.prepend(gm.E("div",{class:`alert alert-${t} alert-dismissible col-xs-12`,role:"alert"},gm.E("button",{"aria-hidden":"true","aria-label":"Close","data-bs-dismiss":"alert",class:"btn-close",type:"button"}),i)),me(s.find(".alert"))):alert(i.textContent)}function S(t,e={}){fe("danger",t,e)}function ge(t,e={}){fe("success",t,e)}var H=m(()=>{"use strict";pe()});function ye(){J=!1,setTimeout(()=>{!J&&$(".loadingAnimation1").hasClass("none")&&($(".loadingAnimation2").css("z-index",2e5),$(".loadingAnimation2").removeClass("none"))},Ne),A+=1,he=setTimeout(G,3e5)}function G(){A-=1,A<0&&(A=0),A==0&&(J=!0,$(".loadingAnimation1").addClass("none"),$(".loadingAnimation2:not(.loader-animation)").addClass("none")),clearTimeout(he)}var Ne,A,he,J,ve=m(()=>{"use strict";Ne=2e3,A=0,J=!1});function*xe(t,e){for(let n=t;n<e.length;n++)yield e[n]}function*Te(t,e){let n=0;for(;n<Math.min(t.length,e.length);n++)yield t[n],yield e[n];n<t.length&&(yield*xe(n,t)),yield*xe(n,e)}var _e=m(()=>{"use strict"});function We(t){return Object.entries(t)}function $e(t,e,n){return We(t).reduce(n,e)}function Xe(t,e){return{...t,...e}}function we(...t){return t.reduce(Xe,{})}var Ae=m(()=>{"use strict"});function Ze(t){if(Object.keys(t).length==0)return"";function e(s,d){return d!=null?`${encodeURIComponent(s)}=${encodeURIComponent(String(d))}`:""}return`?${$e(t,[],(s,[d,i])=>[...s,e(d,i)]).filter(s=>Boolean(s)).join("&")}`}function et(t,...e){if(!t)throw new Error("The route you specified in `urlSpec` is unknown. Did you forget to rebuild after adding a new endpoint?");let n=e.filter(u=>u!==void 0&&typeof u!="object"),r=e.filter(u=>typeof u=="object"),s=Array.isArray(t)?Array.from(Te(t.filter(u=>!u.startsWith("<")),n)).join("/"):t,d=we(...r),i=Ze(d),l=/^[^:]+:\/\//ug,c=s.match(l),L=c!==null?c[0]:"",p=`${s.replace(l,"").replace(/\/\//ug,"/").replace(/\/$/ug,"").replace(/\/\./ug,".")}${i}`;return`${L}${p}`}var b,U=m(()=>{"use strict";_e();Ae();b=et});function nt(t,e){return C({code:"error-generic-with-http-code",message:`An error occurred. Please try again later. (Status: ${e} at ${t})`,args:{url:t,code:e}})}function Pe(t,e={}){return e.method="GET",e.headers={...K,...e.headers},B(t,e)}function ot(t,e={}){return e.method="DELETE",e.headers={...K,...e.headers},e.body=JSON.stringify(e.data),B(t,e)}function rt(t,e={}){return e.method="PUT",k(t,e)}function st(t,e={}){return e.method="POST",k(t,e)}function at(t,e={}){return e.method="PATCH",k(t,e)}function it(t,e={}){return e.method="OPTIONS",k(t,e)}function k(t,e={}){if(e.method!="PUT"&&e.method!="POST"&&e.method!="DELETE"&&e.method!="PATCH"&&e.method!="OPTIONS"||e.data&&e.data.constructor!=Object)throw new Error("Invalid options in `gm.fetch.send()`");return e.headers={...K,...e.headers},e.body=JSON.stringify(e.data),B(t,e)}function lt(t,e){$(".loadingAnimation").removeClass("none");let n=new FormData;for(let[r,s]of Object.entries(e))n.append(r,s[0]);return B(t,{method:"POST",body:n,useLoader:!1}).finally(()=>{$(".loadingAnimation").addClass("none")})}async function Re(t){return await t.text()}async function B(t,e){var z;if(t===void 0)throw new Error("No URL passed into ui/fetch.tsx");let r={...{useLoader:!0,credentials:"same-origin"},...v(e)};r.method=r.method.toUpperCase(),ce("method",r,{GET:!0,POST:!0,PUT:!0,PATCH:!0,OPTIONS:!0,DELETE:!0}[r.method]),$(".btn_ajax").prop("disabled",!0).addClass("disabled"),r.useLoader&&ye();let d=()=>{$(".btn_ajax").prop("disabled",!1).removeClass("disabled"),r.useLoader&&G()},i=a=>{tt.lastError=a,console.warn("Fetch Error:",{...a})},l=a=>{if(a.status>=200&&a.status<300||a.aborted)return null;let g;return a.status>=400&&a.status<500?(g=new h(a.statusText),a.status==411&&gm.captureException(new Error(`Oh no, something went wrong with this ${r.method} request`))):g=new q(a.statusText),g.response=a.clone(),g.url=t,g},c=new h("Logged Out"),L=a=>{if(!a)return a;if(a.response&&(a=a.response),a.code=="not-logged-in")throw console.log("Shut it down"),gm.pubsub.broadcast("base","logged-out"),c;if(a.error&&!a.aborted)throw new h(a.toString());return a},x=await window.fetch(t,r).catch(a=>new Response(JSON.stringify({error:a.toString(),aborted:Ee(a)})));d();let p={},u=l(x),P=null;if(!u&&r.raw_response)return Re(x);try{p=await x.json(),p=L(p)}catch(a){a instanceof SyntaxError&&(u==null?void 0:u.response)?P=await u.response.clone().text():a instanceof h&&(u=a)}if(u){let a=u==c?gm.E("span",{"data-l10n-id":"not-logged-in"},gm.E("a",{href:b(["/login/","<int:companyid>"]),"data-l10n-name":"login-link"})):dt(p,t,x.status);throw u.error_markup=a.cloneNode(!0),u.error_text=u.error_markup.textContent,u.body=P!=null?P:p,i(u),r.errorRenderer?r.errorRenderer(a,p):r.hide_errors||S(a),u}return r.method=="GET"&&((z=gm.sentry)==null||z.addBreadcrumb({category:"fetch_response",level:"debug",data:ct(t,p)})),p}function dt(t,e,n){let r;t.error?r=t.error:t.errors?r=Object.values(t.errors).join(`
`):t.code?r=C(t):r=nt(e,n);let s=new DocumentFragment;return s.append(r),s}function ct(t,e){let n=e;for(;typeof n=="object"&&n!==null&&"data"in n;)n=n.data;return typeof n=="object"&&!Array.isArray(n)&&n!==null&&Object.entries(n).length!==0?n={...n,endpoint:t}:n={data:n,endpoint:t},n}function Ee(t){return t.aborted||ut.some(e=>t.toString().match(e))}function mt(t,e){let n=new AbortController,r=n.signal;return{abort:()=>n.abort(),send:()=>Pe(t,{...e,signal:r})}}function pt(t,e=!1){e&&t.find(":input:disabled").removeAttr("disabled");let n=t.serializeArray(),r={};for(let{name:s,value:d}of n)r[s]=d;return r}var K,tt,M,h,q,ke,ut,ft,y,N=m(()=>{"use strict";H();I();ve();U();ue();K={"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},tt={lastError:null},M=class extends Error{constructor(){super(...arguments);f(this,"response");f(this,"url");f(this,"body");f(this,"error_markup");f(this,"error_text")}},h=class extends M{};h.prototype.name="FetchError";q=class extends M{};q.prototype.name="ServerError";ke=(e=>(e.FETCH="fetch_response",e))(ke||{});ut=[/AbortError/u,/TypeError: NetworkError/u];ft={put:rt,post:st,post_files:lt,patch:at,options:it,send:k,get:Pe,delete:ot,wasAborted:Ee,abortableGet:mt,raw_response:Re,GMCategory:ke,form_to_json:pt},y=ft});function Oe(t,e,n){new j(t,e,n).render()}var gt,j,Ce=m(()=>{"use strict";de();N();U();H();gt={memberId:null,templateField:null,templateData:null,settingsUrl:null};j=class{constructor(e,n,r){this.url=n,this.title=e,this.options=Object.assign(gt,r),this.qrCodeLink="test"}async buttons(){let e=[];return e.push(gm.E("div",{class:"form-group nopadding col-xs-12"},gm.E("a",{type:"button",class:"btn btn-default btn-block",target:"_blank","data-l10n-id":"qr-download-button",id:"qr-download",onClick:this.downloadQRCode}))),e.push(gm.E("div",{class:"form-group nopadding col-xs-12"},gm.E("a",{type:"button",class:"btn btn-default btn-block",target:"_blank","data-l10n-id":"qr-current-device",href:this.url}))),e.push(gm.E("div",{class:"form-group nopadding col-xs-12"},gm.E("a",{type:"button",class:"btn btn-default btn-block",id:"qr-copy-btn"},gm.E("span",{id:"copy-label","data-l10n-id":"qr-copy-to-clipboard"}),gm.E("span",{class:"none",id:"copied-label","data-l10n-id":"qr-copy-to-clipboard-copied",style:{color:"green"}})))),this.options.templateField&&(e.push(gm.E("div",{class:"form-group nopadding col-xs-12"},gm.E("a",{type:"button",class:"btn btn-default btn-block",id:"complete-email","data-l10n-id":"qr-email-to-member"}))),e.push(gm.E("div",{id:"qr-email-selection",class:"none"},gm.E("div",{class:"form-group nopadding col-xs-12"},gm.E("select",{class:"form-control",id:"complete-email-template"},gm.E("option",{value:"","data-l10n-id":"qr-select-email-template"}),await this.get_valid_email_templates())),gm.E("div",{class:"form-group nopadding col-xs-12"},gm.E("a",{type:"button",class:"btn btn-default btn-block",id:"send-email","data-l10n-id":"qr-email-send"}))))),e}async render(){let e=gm.E(gm.F,null,gm.E("div",{class:"other-dev col-xs-12"},gm.E("h4",{"data-l10n-id":"qr-show-on-other-devices"}),gm.E("h5",{"data-l10n-id":"qr-scan-qr-with-camera-on-other-selected-device"}),gm.E("div",{class:"qr-code-pic col-xs-12"},gm.E("img",{class:"img-responsive",id:"complete-qrcode",style:"max-height:250px; margin-left: auto; margin-right: auto; margin-bottom: 20px;"}),await this.buttons()),gm.E("div",{class:"tips-box col-xs-12 col-sm-12"},gm.E("div",{class:"panel-group",id:"accordion-questionnaire",role:"tablist","aria-multiselectable":"true"},gm.E("div",{class:"panel panel-default col-xs-12 nopadding"},gm.E("div",{class:"panel-heading",role:"tab",id:"headingIos"},gm.E("a",{role:"button","data-toggle":"collapse","data-parent":"#accordion-questionnaire",href:"#tips-ios","aria-expanded":"true","aria-controls":"collapseOne"},gm.E("h4",{class:"panel-title","data-l10n-id":"qr-tips-for-ios"}," ")," ",gm.E("span",{class:"gmi gmi-setdown"}))),gm.E("div",{id:"tips-ios",class:"panel-collapse collapse",role:"tabpanel","aria-labelledby":"headingIos"},gm.E("div",{class:"panel-body col-xs-12"},gm.E("ol",null,gm.E("li",{"data-l10n-id":"qr-open-camera-app-on-ipad-iphone"}),gm.E("li",{"data-l10n-id":"qr-hold-camera-up-to-the-qr-code"}),gm.E("li",{"data-l10n-id":"qr-open-qr-code-reader"}),gm.E("li",{"data-l10n-id":"qr-no-need-to-hit-shutter-button-msg"}))))),gm.E("div",{class:"panel panel-default col-xs-12 nopadding"},gm.E("div",{class:"panel-heading",role:"tab",id:"headingAndroid"},gm.E("a",{class:"collapsed",role:"button","data-toggle":"collapse","data-parent":"#accordion-questionnaire",href:"#tips-android","aria-expanded":"false","aria-controls":"collapseTwo"},gm.E("h4",{class:"panel-title","data-l10n-id":"qr-tips-for-android"}," ")," ",gm.E("span",{class:"gmi gmi-setdown"}))),gm.E("div",{id:"tips-android",class:"panel-collapse collapse",role:"tabpanel","aria-labelledby":"headingAndroid"},gm.E("div",{class:"panel-body col-xs-12"},gm.E("ol",null,gm.E("li",{"data-l10n-id":"qr-open-play-store-on-your-android"}),gm.E("li",{"data-l10n-id":"qr-type-qr-code-reader-into-the-search-box-install-app"}),gm.E("li",{"data-l10n-id":"qr-open-qr-code-reader"}),gm.E("li",{"data-l10n-id":"qr-line-up-the-qr-code-camera-frame"}))))))))),{title:n}=this,r,s;this.options.settingsUrl&&(r={label:this.options.settingsLabel||"Settings"},s=()=>{confirm("Changes you have made may not be saved")&&window.location.assign(this.options.settingsUrl)}),ie({body:e,title:n,settingsLink:r,onSettingsClick:s,actionbutton_list:[{label:"Close",is_close:!0}],runInModal:()=>this.runInModal()})}runInModal(){this.fetchQRCode(),$("#complete-email").on("click",()=>{if($("#complete-email-template > option").length>2)$("#qr-email-selection").removeClass("none");else if($("#complete-email-template > option").length==2){let e=$("#complete-email-template").children().last().val();this.sendEmailTemplate(e)}else this.sendEmailTemplate(null)}),$("#send-email").on("click",()=>{let e=$("#complete-email-template").val();e===null||e===""?S({code:"qr-no-template-selected"}):this.sendEmailTemplate(e)}),$("#qr-copy-btn").on("click",()=>{navigator.clipboard.writeText(this.url),$("#qr-copy-btn #copy-label").addClass("none"),$("#qr-copy-btn #copied-label").removeClass("none"),setTimeout(()=>{$("#qr-copy-btn #copy-label").removeClass("none"),$("#qr-copy-btn #copied-label").addClass("none")},1500)})}fetchQRCode(){y.get(b("/qrcode/",{url:this.url})).then(e=>{$(".intro-content").hide(),$(".other-dev").show(),$("#complete-qrcode").attr("src",`data:image/png;base64,${e.barcode}`)})}downloadQRCode(){let e=document.createElement("a");e.href=$("#complete-qrcode").attr("src"),e.download="quickadd_qrcode.png",e.click()}async sendEmailTemplate(e){if(e!==null){let{sent:n}=await y.post(b("/member/communication/qrcoderedirect/email"),{data:{memberid:this.options.memberId,params:this.options.templateData,field:this.options.templateField,templateid:e}});ge(`Successfully sent template "${n}".`)}else{let n=b(["/member/communication/email/","<int:mid>"],this.options.memberId,{source_field:this.options.templateField});window.location.href=n}}async get_valid_email_templates(){let e=[],{templates:n}=await y.get(b("/member/communication/qr_get_valid_email_templates",{field:this.options.templateField}));for(let r of n)e.push(gm.E("option",{value:r.id},r.title));return e}}});var Se,Me=m(()=>{"use strict";Se=gm.l10n});function qe(t,e){let n=Promise.resolve(null),r=!0;return function(...s){return r?(r=!1,t(...s).finally(()=>{r=!0,e&&e()})):n}}var Be=m(()=>{"use strict"});var yt=Ie(()=>{Ce();N();Me();Be();$("#invite_btn").on("click",()=>{let t=Se.formatValue("booking-invite-link");Oe(t,gm.page.invite_url)});async function ht(t,e){let{disabled:n}=await y.get(`/booking/check_disabled_booking/${t}/${gm.page.arrival}`);if(n===!0){notificationError("Member is on hold during this class and has booking disabled. Cancel the member's hold in order to make a booking.");return}let r=await y.get(`/booking/classservicelist/${t}/${gm.page.arrival}/${e}`),s=!1,d=!1;for(let l of r){if(l.can_book==!0&&(s=!0,l.take_concession==!1&&l.free==!0&&(l.benefitid==null||l.benefitid=="")&&!$("#seatallocation").val())){add_to_class_silently(t,e);return}d=l.prospect}if(s){add_to_class_prompt(t,e);return}let i=" has no available service for this class.";d?(i=`Prospect${i}`,i+=" Please check that this class allows casual enrollment",i+=" and that the prospect has not reached their limit for classes they are allowed to book."):(i=`Member${i}`,i+=" Please check that the member has the correct benefits to booking into this class",i+=" and that the benefit is not being blocked by an insufficient balance or the member owing more than the stop on owe threshold."),notificationError(i)}gm.add_to_class=qe(ht)});export default yt();
//# sourceMappingURL=booking_class-5EMD77UR.js.map
